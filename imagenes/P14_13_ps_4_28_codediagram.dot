digraph P14_13_ps_4_28_Flowchart {
    // Configuracion general del grafo
    rankdir=TB;
    node [fontname="Helvetica", fontsize=10];
    edge [fontname="Helvetica", fontsize=9];

    // Definicion de estilos de nodos
    node_start_end [shape=ellipse, style=filled, fillcolor="#E6E6FA"];
    node_process [shape=box, style=filled, fillcolor="#ADD8E6"];
    node_io [shape=parallelogram, style=filled, fillcolor="#FFFACD"];
    node_decision [shape=diamond, style=filled, fillcolor="#FFDAB9", width=2.5, height=1.5];

    // Nodos del diagrama
    start [label="INICIO", shape=ellipse, style=filled, fillcolor=lightgrey];
    end [label="FIN", shape=ellipse, style=filled, fillcolor=lightgrey];

    declare_vars [label="DECLARAR\nScanner scanner, int N\nint[][] A, int sumaReferencia\nboolean esMagico = true", shape=box, style=filled, fillcolor=lightblue];
    prompt_n [label="IMPRIMIR 'Introduce el tamano de la matriz (N):'", shape=parallelogram, style=filled, fillcolor=lightgoldenrod1];
    read_n [label="LEER N", shape=parallelogram, style=filled, fillcolor=lightgoldenrod1];
    create_matrix [label="Crear matriz A[N][N]", shape=box, style=filled, fillcolor=lightblue];
    
    prompt_elements [label="IMPRIMIR 'Introduce los elementos de la matriz:'", shape=parallelogram, style=filled, fillcolor=lightgoldenrod1];
    read_loop [label="BUCLE i=0 hasta N-1\n  BUCLE j=0 hasta N-1\n    IMPRIMIR 'Elemento [i][j]: '\n    LEER A[i][j]", shape=box, style=filled, fillcolor=lightblue];

    calc_ref [label="sumaReferencia = Suma de la fila 0 de A", shape=box, style=filled, fillcolor=lightblue];

    verify_rows [label="Verificar suma de filas 1 a N-1\nSi alguna suma es diferente a sumaReferencia\n  esMagico = false", shape=box, style=filled, fillcolor=lightblue];
    verify_cols [label="Verificar suma de todas las columnas\nSi alguna suma es diferente a sumaReferencia\n  esMagico = false", shape=box, style=filled, fillcolor=lightblue];
    verify_diag1 [label="Verificar suma de diagonal principal\nSi la suma es diferente a sumaReferencia\n  esMagico = false", shape=box, style=filled, fillcolor=lightblue];
    verify_diag2 [label="Verificar suma de diagonal secundaria\nSi la suma es diferente a sumaReferencia\n  esMagico = false", shape=box, style=filled, fillcolor=lightblue];

    decision_final [label="Â¿esMagico es true?", shape=diamond, style=filled, fillcolor=khaki];
    print_magico [label="IMPRIMIR 'La matriz es un cuadrado magico'", shape=parallelogram, style=filled, fillcolor=lightgoldenrod1];
    print_no_magico [label="IMPRIMIR 'La matriz no es un cuadrado magico'", shape=parallelogram, style=filled, fillcolor=lightgoldenrod1];
    
    close_scanner [label="Cerrar Scanner", shape=box, style=filled, fillcolor=lightblue];

    // Conexiones del flujo
    start -> declare_vars;
    declare_vars -> prompt_n -> read_n -> create_matrix;
    create_matrix -> prompt_elements -> read_loop;
    read_loop -> calc_ref;
    calc_ref -> verify_rows;
    verify_rows -> verify_cols;
    verify_cols -> verify_diag1;
    verify_diag1 -> verify_diag2;
    verify_diag2 -> decision_final;

    decision_final -> print_magico [label="Si"];
    decision_final -> print_no_magico [label="No"];

    print_magico -> close_scanner;
    print_no_magico -> close_scanner;
    close_scanner -> end;
}